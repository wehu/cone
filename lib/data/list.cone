module data/list

fun reverse<a>(l : [a]) : [a] {
  var rest = l
  var newl = []
  while (rest != []) {
    val e|r = rest
    rest = r
    newl = e|newl
  }
  newl
}

fun map<a, b>[e](l : [a], f : (a) -> e b) : e [b] {
  if l == [] {
    []
  } else {
    val e|r = l
    f(e)|map(r, f)
  }
}

fun length<a>(l : [a]) : i32 {
  if l == [] {
    0
  } else {
    val e|r = l
    1 + length(r)
  }
}